# AIOS - Changelog and History of Changes

## 2026-02-21

*   **Web Speech API Integration**: Added vocal interaction capabilities to
    `chat.prg` using the native browser `SpeechRecognition` API. Users can now
    click a microphone icon to transcribe spoken Spanish directly into the chat
    input, with automatic submission upon pausing.

*   **Web Speech Synthesis (TTS)**: Added automatic text-to-speech reading of AI
    responses in `chat.prg` using the native browser `SpeechSynthesis` API.
    Included a mute/unmute toggle switch (ðŸ”Š) and a dropdown selector to choose
    between different Spanish voices available in the operating system.
    *   **Update**: Configured the dropdown to prioritize the "Google espaÃ±ol de
        Estados Unidos" default voice.
    *   **Update**: Added regex filters to prevent the system from verbally
        reading base64 image data strings when generating pictures.

*   **AI Image Generation**: Introduced a new `image_gen` backend skill using
    the Gemini Imagen API (specifically targeting `nano-banana-pro-preview` for
    high quality generation). 
    *   **Optimization**: Built a reasoning-loop interceptor in `aios.prg` that
        injects the 3MB+ Base64 image directly into the UI without sending it
        back for the LLM to process, saving massive token allocations.

## 2026-02-20

*   **Indentation Standard**: Enforced a strict 3-space indentation rule across
    all `.prg` files to ensure consistent code formatting.

*   **Web Search Skill**: Implemented `websearch.prg` to search the web using
    DuckDuckGo via `hbcurl`.

*   **Syntax Corrections**:
    *   Fixed `At()` function calls in Harbour 3.0+ to use `hb_At()` when
        specifying a start position.
    *   Corrected Hash Map syntax error from using `:` to the native `=>`
        operator.

*   **Keyword Standards**: Updated `SKILL.md` to strictly enforce the use of the
    full `return` keyword instead of the abbreviated `retu`. Replaced all
    instances of `retu` with `return` across all `.prg` files.

*   **Variables Spacing**: Updated `SKILL.md` to require one blank line after
    `local` variable definitions. Applied this formatting rule across all
    `.prg` files.

*   **Language Standards**: Updated `SKILL.md` rules requiring all comments
    within `.prg` files to be written in English. Ran a script to translate
    all existing Spanish comments.

*   **Function and Local Spacing**: Updated `SKILL.md` to require exactly one
    blank line after `function` declarations (before `local` variables) and
    another after `local` variables block. Ran formatter to apply this across
    all `.prg` files.

*   **Expression Formatting**: Updated `SKILL.md` to mandate a space after the
    logical NOT operator (`! `) and spaces inside parentheses (`( ... )`).

*   **General Behavior**: Created a new `SKILL.md` under `general_behavior` to
    systematically enforce the cleanup of temporary `.py` and `.html` workspace
    files, maintaining directory integrity.

*   **Context Optimization**: Refactored `aios.prg` to disable redundant
    injection of `MEMORY.md` into the dynamic system prompt, eliminating the
    AI repeating full conversational history.

*   **Chat HTML UI Formatting**: Fixed the UI line-break rendering bug in
    `chat.prg` by implementing a split/join strategy to reliably convert textual
    `\n` carriage returns into HTML `<br>` tags alongside setting `white-space:
    pre-wrap`.

*   **AI Persona**: Reviewed and activated the AI persona skill (`IDENTITY.md`,
    `SOUL.md`), confirming automatic integration with AI responses.

*   **Dual Web Search**: Refactored the `web_search` skill to support dual
    searching due to DuckDuckGo CAPTCHA blocks. Integrated Wikipedia JSON
    extraction for encyclopedic searches (`websearch_wiki.prg`), and Google
    Serper API extraction via `serper_config.json` for live web searches
    (`websearch.prg`).

*   **Token Pricing and Counting**: Included logic in `aios.prg` and `chat.prg`
    to visually track the execution cost and number of tokens consumed by
    standard API usage. Resolved Harbour string syntax parsing errors inside
    Javascript templates.

*   **Version Control**: Reset ultra-stable version tracking from 1.7 back to
    standard 1.0 release branch across all core scripts.

*   **OS Hardware Integration**: Expanded the `filesystem` skill by integrating
    powerful Windows Management Instrumentation (WMI) routines within a new
    `os_hardware_control` core component. AIOS can now execute native
    percentage-based Volume and Brightness adjustments, extract Battery
    diagnostic read-outs, and instantly toggle Power modes (Lock, Sleep,
    Reboot, Shutdown) executing powershell COM objects directly from Harbour.

*   **Web Frontend Reactivity**: Upgraded `aios.prg` reasoning loop to intercept
    and execute `js_eval` Javascript payloads generated by the AI. This
    effectively bridges the OpenClaw backend with the user's browser in
    `chat.prg` via a global `new Function()` scoped constructor.

*   **Frontend Interval DOM Manipulation**: Added the `frontend_set_interval`
    and `frontend_clear_intervals` capabilities to the `Aios_Cron` module,
    allowing the AI to bind background automated chat query tasks straight
    to the client. Deployed `frontend_execute_js` enabling the Assistant to
    dynamically alter the styles, colors, and layout of its own chat Interface.

*   **Web Scheduled Reminders**: Refactored `cron_add_reminder` to bypass
    background Telegram threads and utilize native browser timeout evaluation
    when the `chat_id` parameter resolves to empty or "web".
